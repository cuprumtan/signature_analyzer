# signature analyzer
---

Программа реализует поиск определенного вируса по его сигнатуре.

Струтура:
```
signature_analyzer
│   README.md
│   config.yml     # конфигурационный файл    
│
└───main.py        # поиск вируса по сигнатуре
│   │   signature_searching.py
│   │   file_searching.py
│   │   signature_searching.log
│   
└───bigrams.py      # создание набора биграмма:вероятность появления
│   │   bigrams.txt
│   
```

#### bigrams.py
---
Создает набор биграмм с их логарифмическими вероятностями для более точного определения уникальной сигнатуры. Для поиска биграмм был использован набор тестовых незараженных программ.
Чтобы получить общие логарифмические вероятности появления каждой биграммы для каждого файла были вычислены логарифмические вероятности появления биграмм в конкретном файле:  
***p(bigram) = lg(count(bigram)/N)***, где *N* - количество всех биграмм в файле  
просуммированы друг с другом и поделены на количество файлов:  
***P(bigram) = ∑(lg(count(bigram)/N))/M***, где *M* - количество файлов  

Для определения общей логарифмической вероятности сигнатуры необходимо просуммировать по порядку все логарифмические вероятности встречающихся в сигнатуре биграмм. Наиболее подходящей считается сигнатура с наименьшей вероятностью, так как обладает большей уникальностью по сравнению с незараженными "обычными" файлами.

#### main.py
---
Реализует получение сигнатуры и поиск в определенной заданной директории вируса. Все параметры настраиваются:
**config.py**:
- test_dir - директория с набором зараженных файлов, на основании которых проверяется уникальность вирусной сигнатуры;
- search_dir - директория, в которой будет проводится поиск;
- signature_file - зараженный файл, сигнатуру которого ищем;
- signature_size - размер сигнатуры в байтах (от 32 до 256);
- log_file - лог-файл;
